#!/bin/sh
# Change volume and play a sound.
# Inspired by https://bbs.archlinux.org/viewtopic.php?id=132218.

step=${2:-2}

case "$1" in
    up|down|set)
        pulseaudio-ctl "$1" "$step"
        paplay /usr/share/sounds/freedesktop/stereo/audio-volume-change.oga &
        ;;
    mute)
        pulseaudio-ctl mute
        ;;
esac

current=$(pulseaudio-ctl current)
if [ "$(pulseaudio-ctl full-status | cut -d' ' -f2)" = yes ]
then
    icon=audio-volume-muted
    title='Volume (muted)'
    if [ "$1" = mute ]
    then
        current='0%'
    fi
else
    icon=multimedia-volume-control
    title='Volume'
fi
hints="-h int:value:$current -h string:synchronous:volume"

notify-send -a vol -t 1000 -i "$icon" -h int:transient:1 ${hints:+$hints} "$title" "$current"
